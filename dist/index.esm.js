function e(e){try{var o=e.match(/^[A-Z]+(?=\()/);if(!o)return void console.log("wkt数据格式不对,没有解析到type");var t=o[0],r=void 0;if("POINT"===t){if(!(l=e.match(/(-*\d+\.*\d*\s-*\d+\.*\d*)/g)))return void console.log("没有解析到POINT的坐标");r={type:"Point",coordinates:a=l[0].split(" ").map(Number)}}else if("LINESTRING"===t){if(!(l=e.match(/(-*\d+\.*\d*\s-*\d+\.*\d*)/g)))return void console.log("没有解析到LINESTRING的坐标");var n=[];l.forEach((function(e){n.push(e.split(" ").map(Number))})),r={type:"LineString",coordinates:n}}else if("MULTIPOINT"===t){var l;if(!(l=e.match(/(-*\d+\.*\d*\s-*\d+\.*\d*)/g)))return void console.log("没有解析到MULTIPOINT的坐标");var i=[];l.forEach((function(e){i.push(e.split(" ").map(Number))})),r={type:"MultiPoint",coordinates:i}}else if("POLYGON"===t){for(var s=e.split(/,(?=\()/),a=[],c=function(e){var o=s[e].match(/(-*\d+\.*\d*\s-*\d+\.*\d*)/g);if(!o)return console.log("没有解析到POLYGON的坐标"),{value:void 0};var t=[];o.forEach((function(e){t.push(e.split(" ").map(Number))})),a.push(t)},u=0;u<s.length;u++){var p=c(u);if("object"==typeof p)return p.value}r={type:"Polygon",coordinates:a}}else if("MULTILINESTRING"===t){s=e.split(/,(?=\()/),a=[];var f=function(e){var o=s[e].match(/(-*\d+\.*\d*\s-*\d+\.*\d*)/g);if(!o)return console.log("没有解析到MULTILINESTRING的坐标"),{value:void 0};var t=[];o.forEach((function(e){t.push(e.split(" ").map(Number))})),a.push(t)};for(u=0;u<s.length;u++){var g=f(u);if("object"==typeof g)return g.value}r={type:"MultiLineString",coordinates:a}}else if("MULTIPOLYGON"===t){var y=e.split(/,(?=\(\()/);for(a=[],u=0;u<y.length;u++){for(var h=y[u].split(/,(?=\()/),N=[],L=function(e){var o=h[e].match(/(-*\d+\.*\d*\s-*\d+\.*\d*)/g);if(!o)return console.log("没有解析到MULTIPOLYGON的坐标"),{value:void 0};var t=[];o.forEach((function(e){t.push(e.split(" ").map(Number))})),N.push(t)},d=0;d<h.length;d++){var v=L(d);if("object"==typeof v)return v.value}a.push(N)}r={type:"MultiPolygon",coordinates:a}}return r}catch(e){console.log("格式解析出错",e)}}function o(o){console.log(o);try{var t=(o=o.replaceAll("\n"," ").replaceAll(/\s+/g," ").replaceAll(" ,",",").replaceAll(", ",",").replaceAll(" (","(").replaceAll("( ","(").replaceAll(" )",")").replaceAll(") ",")").toUpperCase()).match(/^[A-Z]+(?=\()/);if(!t)return void console.log("wkt数据格式不对,没有解析到type");var r=t[0];if("GEOMETRYCOLLECTION"===r){for(var n=(o=o.substring(19,o.length-1)).split(/,(?=[A-Z]+)/),l=[],i=0;i<n.length;i++){if(!(s=e(n[i])))return;l.push({type:"Feature",geometry:s,properties:{}})}return{type:"FeatureCollection",features:l}}if((n=o.split(/,(?=[A-Z]+)/)).length>1){for(l=[],i=0;i<n.length;i++){if(!(s=e(n[i])))return;l.push({type:"Feature",geometry:s,properties:{}})}return{type:"FeatureCollection",features:l}}if(["POINT","LINESTRING","POLYGON","MULTIPOINT","MULTILINESTRING","MULTIPOLYGON"].includes(r)){var s;if(!(s=e(o)))return;return{type:"Feature",geometry:s}}return void console.log("wkt数据的type不太对--\x3e",r)}catch(e){console.log("格式解析出错",e)}}function t(e){if(!e)return console.log("没有geojson数据"),"";var o=e.type;if(!o)return console.log("数据中没有type"),"";if("string"!=typeof o)return console.log("数据中的type不是字符串"),"";var t=e.coordinates;if(!t)return console.log("数据中没有coordinates"),"";if(!(t instanceof Array))return console.log("数据的coordinates不是数组"),"";if(0===t.length)return console.log("数据的coordinates是空的"),"";var r=[];switch(o.toUpperCase()){case"POINT":if(t.length<2)return console.log("type为Point的coordinates格式不对--\x3e",t),"";for(var n=0;n<t.length;n++)if("number"!=typeof t[n]||isNaN(t[n]))return console.log("type为Point的coordinates格式不对--\x3e",t[n]),"";r.push(t.slice(0,2).join(" "));break;case"LINESTRING":case"MULTIPOINT":for(n=0;n<t.length;n++){var l=t[n];if(!(l instanceof Array)||l.length<2)return console.log("type为MultiPoint或LineString的coordinates格式不对--\x3e",l),"";for(var i=0;i<l.length;i++)if("number"!=typeof l[i]||isNaN(l[i]))return console.log("type为MultiPoint或LineString的coordinates格式不对--\x3e",l[i]),"";r.push(l.slice(0,2).join(" "))}break;case"POLYGON":case"MULTILINESTRING":for(n=0;n<t.length;n++){var s=[];if(!((c=t[n])instanceof Array))return console.log("type为Polygon或MultiLineString的coordinates格式不对--\x3e",c),"";for(i=0;i<c.length;i++){if(!((p=c[i])instanceof Array)||p.length<2)return console.log("type为Polygon或MultiLineString的coordinates格式不对--\x3e",p),"";for(var a=0;a<p.length;a++)if("number"!=typeof p[a]||isNaN(p[a]))return console.log("type为Polygon或MultiLineString的coordinates格式不对--\x3e",p[a]),"";s.push(p.slice(0,2).join(" "))}r.push("(".concat(s.join(","),")"))}break;case"MULTIPOLYGON":for(n=0;n<t.length;n++){var c,u=[];if(!((c=t[n])instanceof Array))return console.log("type为MultiPolygon的coordinates格式不对--\x3e",c),"";for(i=0;i<c.length;i++){var p;s=[];if(!((p=c[i])instanceof Array))return console.log("type为MultiPolygon的coordinates格式不对--\x3e",p),"";for(a=0;a<p.length;a++){var f=p[a];if(!(f instanceof Array)||f.length<2)return console.log("type为MultiPolygon的coordinates格式不对--\x3e",f),"";for(var g=0;g<f.length;g++)if("number"!=typeof f[g]||isNaN(f[g]))return console.log("type为Polygon或MultiLineString的coordinates格式不对--\x3e",f[g]),"";s.push(f.slice(0,2).join(" "))}u.push("(".concat(s.join(","),")"))}r.push("(".concat(u.join(","),")"))}break;default:return console.log("这个geojson中的type值好像不太对--\x3e type: ".concat(o)),""}return"".concat(o.toUpperCase(),"(").concat(r.join(","),")")}function r(e){if(!e)return console.log("没有geojson数据"),"";var o=e.type;if(!o)return console.log("这个geojson没有type"),"";if("string"!=typeof o)return console.log("这个geojson的type不是字符串"),"";if(["POINT","LINESTRING","POLYGON","MULTIPOINT","MULTILINESTRING","MULTIPOLYGON"].includes(o.toUpperCase()))return t(e);if("FEATURE"===o.toUpperCase()){if(!(c=e.geometry))return console.log("type为Feature的数据没有geometry--\x3e",e),"";if("GEOMETRYCOLLECTION"===c.type.toUpperCase()){var r=c.geometries;return"GEOMETRYCOLLECTION(".concat(n(r),")")}return t(c)}if("GEOMETRYCOLLECTION"===o.toUpperCase()){var l=n(r=e.geometries);return"GEOMETRYCOLLECTION(".concat(l,")")}if("FEATURECOLLECTION"===o.toUpperCase()){var i=[],s=e.features;if(!s)return console.log("type为FeatureCollection的数据没有features--\x3e",e),"";if(!(s instanceof Array))return console.log("type为FeatureCollection的数据中features不是数组--\x3e",e),"";for(var a=0;a<s.length;a++){var c,u=s[a],p=u.type;if(!p)return console.log("这个feature没有type--\x3e",u),"";if("string"!=typeof p)return console.log("这个feature的type不是字符串--\x3e",u),"";if(!(c=u.geometry))return console.log("这个feature没有geometry--\x3e",u),"";if("GEOMETRYCOLLECTION"===c.type.toUpperCase()){r=c.geometries;i.push(n(r))}else i.push(t(c))}return"GEOMETRYCOLLECTION(".concat(i.join(","),")")}return console.log("这个geojson的type值好像不太对--\x3e type: ".concat(o)),""}function n(e){var o=[];if(!e)return console.log("type为GeometryCollection的数据没有geometries--\x3e",e),"";if(!(e instanceof Array))return console.log("type为GeometryCollection的数据中geometries不是数组--\x3e",e),"";for(var r=0;r<e.length;r++)o.push(t(e[r]));return o.join(",")}export{r as geojsonToWkt,o as wktToGeojson};
